# Vkgram

## –ù–∞–≤–∏–≥–∞—Ü–∏—è üó∫Ô∏è

- [–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞](../src/messanger)
- [–°–µ—Ä–≤–µ—Ä](../src/server)
- [–ö–ª–∏–µ–Ω—Ç](../src/client)
- [–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–ª–∏–µ–Ω—Ç–∞](../src/interface)
- [–ë—É—Ñ–µ—Ä—ã (–∑–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã) + —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è](../src/buffers)
- [–ë–î](../src/database)

## –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

![](../images/structure.jpg)

## –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä

–í –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–æ—Å—Ç–∞–≤–ª—è—é—â–µ–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –≤—ã–¥–µ–ª–µ–Ω—ã –¥–≤–µ —Å—É—â–Ω–æ—Å—Ç–∏: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ

<img src="../images/user_mes.jpg" alt="drawing" width="600"/>

## –ó–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã

–£ –∫–ª–∏–µ–Ω—Ç–∞ –µ—Å—Ç—å 6 –≤–∏–¥–æ–≤ –∑–∞–ø—Ä–æ—Å–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É:

### 1. –ó–∞–ø—Ä–æ—Å—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ - `Login`, `Register`
–ö–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç –≤–≤–µ–¥–µ–Ω–Ω—ã–µ username –∏ –ø–∞—Ä–æ–ª—å, –æ–∂–∏–¥–∞—è –æ—Ç–≤–µ—Ç –æ–± —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ - `GetConatcts`
–ó–∞–ø—Ä–æ—Å —Å–ø–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã —É–∂–µ –æ–±—â–∞–ª–∏—Å—å. –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ list[User].

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º - `GetHistory`
–ó–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø–æ –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É. 

### 4. –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è - `SendMessage`
–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–∞ –∏ –∞–¥—Ä–µ—Å–∞—Ç–∞ –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### 5. –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - `GetUser`
–ü–æ–ª—É—á–µ–Ω–∏—è id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –µ–≥–æ username - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞ —Å –Ω–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è, –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ `Buffer`, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ tcp —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—é. –ü–æ—Å–ª–µ —Å–µ—Ä–≤–µ—Ä –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç 
–∑–∞–ø—Ä–æ—Å, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–≥–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç —Ç–∞–∫–∏–º –∂–µ –æ–±—Ä–∞–∑–æ–º.

## –°–µ—Ä–≤–µ—Ä

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è/–º–µ—Ç–æ–¥—ã —Å–∫—Ä—ã—Ç—ã –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã):

<img src="../images/server_structure.jpg" alt="drawing" width="600"/>

–°–µ—Ä–≤–µ—Ä —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä–µ—Ö –º–æ–¥—É–ª–µ–π:

1. `Server` - –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç —Å–≤—è–∑—å —Å –∫–ª–∏–µ–Ω—Ç–æ–º. –ó–∞–≤–æ–¥–∏—Ç 4 –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ –∑–∞–ø—Ä–æ—Å—É kqueue —á–∏—Ç–∞—é—Ç `Buffer` –∏ –ø–µ—Ä–µ–¥–∞—é—Ç –µ–≥–æ
`RequestHandler`
2. `RequestHandler` - –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –æ—Ç–≤–µ—Ç–∞, –æ–±—Ä–∞—â–∞—è—Å—å –ø—Ä–∏ —ç—Ç–æ–º –∫ `ServerDatabaseModule`. –£ –Ω–µ–≥–æ
–µ—Å—Ç—å —Å–≤–æ–π –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç –µ–≥–æ —Ä–∞–±–æ—Ç—É.
3. `ServerDatabaseModule` - –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –í –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å—Ç–æ–ª—å–∫–æ –∂–µ, —Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤
—É `RequestHandler`. –ö–∞–∂–¥—ã–π –≤–æ—Ä–∫–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å–≤–æ–∏–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º, –ø–æ—ç—Ç–æ–º—É –∑–¥–µ—Å—å –≥–æ–Ω–æ–∫ –Ω–µ—Ç.

## –ö–ª–∏–µ–Ω—Ç

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è/–º–µ—Ç–æ–¥—ã —Å–∫—Ä—ã—Ç—ã –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã):

<img src="../images/client_structure.jpg" alt="drawing" width="600"/>

–ö–ª–∏–µ–Ω—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä–µ—Ö –º–æ–¥—É–ª–µ–π:

1. `MainWindow` - –∫–ª–∞—Å—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Å –ø–æ–º–æ—â—å—é Qt. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è QtDesigner.
2. `Client` - –º–æ–¥—É–ª—å, —Å–≤—è–∑—ã–≤–∞—é—â–∏–π –ª–æ–≥–∏–∫—É –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Å–µ—Ä–≤–µ—Ä. –°–æ–∑–¥–∞–µ—Ç –¥–≤–∞ –ø–æ—Ç–æ–∫–∞-–≤–æ—Ä–∫–µ—Ä–∞: –æ–¥–∏–Ω –¥–ª—è
–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—Ç–æ—Ä–æ–π –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –î–æ—Å—Ç—É–ø –∫ tcp-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—é –æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ñ–∞–π–±–µ—Ä–Ω—ã–º –º—å—é—Ç–µ–∫—Å–æ–º.
3. `ClientNetworkModule` - –º–æ–¥—É–ª—å, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ –æ—Ç–ø—Ä–∞–≤–∫—É/–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ tcp-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—é.

## –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–æ—Å—Ç–µ–π—à–∏–π (–∏ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π) –≤–∞—Ä–∏–∞–Ω—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π –ø—É—Ç–µ–º –µ–∂–µ—Å–µ–∫—É–Ω–¥–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞
–∫ —Å–µ—Ä–≤–µ—Ä—É –æ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤—Å–µ—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ç–µ–∫—É—â–∏–º —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–º. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞ –æ —Ç–∞–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–∫–∞ —á—Ç–æ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∞
–Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã Qt.
